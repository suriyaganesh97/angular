-- order count of private store users for orders placed till Mar 31
SELECT MBRGRPNAME as privateStoreName,COUNT(*) as orderCount FROM ORDERS O JOIN MBRGRPMBR MG ON O.MEMBER_ID=MG.MEMBER_ID
JOIN MBRGRP X ON MG.MBRGRP_ID=X.MBRGRP_ID
JOIN USERS U on U.USERS_ID=MG.MEMBER_ID WHERE o.timeplaced < to_date('31-MAR-21 11:59:59 PM', 'dd-Mon-yy HH:MI:SS PM')  and status='F' and X.MBRGRP_ID in ('8000000000000000502','8000000000000000504','8407790678950002502','8407790678950003002','8407790678950003003','8407790678950005002','8407790678950005502','8407790678950006002','8407790678950006003','8407790678950007502','8407790678950008003','8407790678950008004','8407790678950008005','8407790678950008006','8407790678950009003','8407790678950009502','8407790678950009503','8407790678950010002','8407790678950010502','8407790678950011002','8407790678950011003','8407790678950011502','8407790678950012002','8407790678950013002','8407790678950013503','8407790678950014002') and timeplaced is not null
GROUP BY MBRGRPNAME ORDER BY MBRGRPNAME;


-- order count of private store users for orders placed after Mar 31 to till date
SELECT MBRGRPNAME as privateStoreName,COUNT(*) as orderCount FROM ORDERS O JOIN MBRGRPMBR MG ON O.MEMBER_ID=MG.MEMBER_ID
JOIN MBRGRP X ON MG.MBRGRP_ID=X.MBRGRP_ID
JOIN USERS U on U.USERS_ID=MG.MEMBER_ID WHERE o.timeplaced between to_date('31-MAR-21 11:59:59 PM', 'dd-Mon-yy HH:MI:SS PM') and sysdate and status='F' and X.MBRGRP_ID in ('8000000000000000502','8000000000000000504','8407790678950002502','8407790678950003002','8407790678950003003','8407790678950005002','8407790678950005502','8407790678950006002','8407790678950006003','8407790678950007502','8407790678950008003','8407790678950008004','8407790678950008005','8407790678950008006','8407790678950009003','8407790678950009502','8407790678950009503','8407790678950010002','8407790678950010502','8407790678950011002','8407790678950011003','8407790678950011502','8407790678950012002','8407790678950013002','8407790678950013503','8407790678950014002') and timeplaced is not null
GROUP BY MBRGRPNAME ORDER BY MBRGRPNAME;

--users count registered till Mar 31
select MBRGRPNAME as privateStoreName,COUNT(*) as UsersCount FROM USERS U JOIN MBRGRPMBR MG ON U.USERS_ID=MG.MEMBER_ID
JOIN MBRGRP P ON P.MBRGRP_ID=MG.MBRGRP_ID
WHERE REGISTRATION < to_date('31-MAR-21 11:59:59 PM', 'dd-Mon-yy HH:MI:SS PM')
and P.MBRGRP_ID in ('8000000000000000502','8000000000000000504','8407790678950002502','8407790678950003002','8407790678950003003','8407790678950005002','8407790678950005502','8407790678950006002','8407790678950006003','8407790678950007502','8407790678950008003','8407790678950008004','8407790678950008005','8407790678950008006','8407790678950009003','8407790678950009502','8407790678950009503','8407790678950010002','8407790678950010502','8407790678950011002','8407790678950011003','8407790678950011502','8407790678950012002','8407790678950013002','8407790678950013503','8407790678950014002')
GROUP BY MBRGRPNAME order by MBRGRPNAME;

--users count registered from Mar 31 to till date
select MBRGRPNAME as privateStoreName,COUNT(*) as UsersCount FROM USERS U JOIN MBRGRPMBR MG ON U.USERS_ID=MG.MEMBER_ID
JOIN MBRGRP P ON P.MBRGRP_ID=MG.MBRGRP_ID
WHERE REGISTRATION between to_date('31-MAR-21 11:59:59 PM', 'dd-Mon-yy HH:MI:SS PM') and sysdate 
and P.MBRGRP_ID in ('8000000000000000502','8000000000000000504','8407790678950002502','8407790678950003002','8407790678950003003','8407790678950005002','8407790678950005502','8407790678950006002','8407790678950006003','8407790678950007502','8407790678950008003','8407790678950008004','8407790678950008005','8407790678950008006','8407790678950009003','8407790678950009502','8407790678950009503','8407790678950010002','8407790678950010502','8407790678950011002','8407790678950011003','8407790678950011502','8407790678950012002','8407790678950013002','8407790678950013503','8407790678950014002')
GROUP BY MBRGRPNAME order by MBRGRPNAME;